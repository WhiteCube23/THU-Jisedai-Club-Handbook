\documentclass[twoside,12pt]{book}
\usepackage[fontset=none]{ctex}
\setCJKmainfont{SimSun}[
  BoldFont = SimHei,
  ItalicFont = KaiTi,
  BoldItalicFont = KaiTi
]
\usepackage{tcolorbox}
\tcbuselibrary{skins, breakable}
\usepackage{tikz}
\usepackage{graphicx}
\graphicspath{{figures/}}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{textcomp}
%\usepackage{showframe}
\usepackage{fancyhdr}
\usepackage{comment}
\usepackage{adjustbox}
\usepackage{eso-pic}
\usepackage{ragged2e}
\usepackage{tikz}
\usepackage{multicol}
\usepackage{enumitem}
\newenvironment{categorysection}[1]{
  \subsection*{\textcolor{truepurple}{#1}}
  \begin{itemize}[leftmargin=*, 
                 nosep,               % 移除所有额外间距
                 itemsep=2pt,         % 条目间距=0
                 parsep=0pt,          % 段落间距=0
                 before=\setlength{\baselineskip}{23pt} % 设置行距
  ]
}{
  \end{itemize}
}
\usetikzlibrary{calc,positioning}
\usetikzlibrary{shapes, arrows}  

\geometry{a4paper, left=1.5cm, right=1.5cm, top=2cm, bottom=3cm}
\setCJKsansfont{SimHei}
\definecolor{truepurple}{RGB}{128, 0, 128}
\definecolor{taopink}{HTML}{F17F98}
\definecolor{tao}{HTML}{FFF2F9}
\definecolor{zi}{HTML}{F8F2F9}
\definecolor{qing}{HTML}{F2F9EA}
\definecolor{default}{gray}{0.05}
\usetikzlibrary{fadings}
\geometry{
  top=1.5cm,       % 从3cm减小到1.5cm
  headheight=20.57637pt, % 解决fancyhdr警告
  headsep=10pt,     % 增加页眉与正文间距
  footskip=30pt     % 增加页脚与正文间距
}

% 定义聊天气泡样式
\newcounter{chatcounter}
\newcommand{\chind}{\hspace*{2em}}
\newcommand{\chatbubble}[5][left]{%
  \stepcounter{chatcounter}%
  \par\noindent%
  \ifstrequal{#1}{left}
    {% 左侧气泡
     \begin{minipage}[t]{1.2cm} % 头像宽度
        \begin{tikzpicture}[baseline=(current bounding box.center)]
          \node[circle, draw=gray!50, line width=0.5pt, minimum size=1.2cm, 
                path picture={\node at (path picture bounding box.center) 
                {\includegraphics[width=1.2cm]{#2}};}] {};
        \end{tikzpicture}
     \end{minipage}%
     \hspace{0.2cm}%
     \begin{minipage}[t]{0.7\textwidth} % 消息框宽度
        \vspace{-15pt} % 确保顶部对齐
        \noindent\textcolor{darkgray!80}{\sffamily #3} % 昵称
        \vspace{5pt}
        \begin{tcolorbox}[
          enhanced,
          breakable,
          colback={#5},
          colframe={#5},
          arc=8pt,
          boxrule=0.5pt,
          left=8pt,
          right=8pt,
          top=4pt,
          bottom=4pt,
          before skip=0pt,
          after skip=10pt,
          width=\linewidth
        ]
          #4
        \end{tcolorbox}
     \end{minipage}
    }
    {% 右侧气泡
     \hfill%
     \begin{minipage}[t]{0.7\textwidth} % 消息框宽度
        \vspace{-15pt} % 确保顶部对齐
        \noindent\hfill\textcolor{darkgray!80}{\sffamily #3} % 右对齐昵称
        \vspace{5pt}
        \hfill%
        \begin{tcolorbox}[
          enhanced,
          breakable,
          colback={#5},
          colframe={#5},
          arc=8pt,
          boxrule=0.5pt,
          left=8pt,
          right=8pt,
          top=4pt,
          bottom=4pt,
          before skip=0pt,
          after skip=10pt,
          width=\linewidth
        ]
          #4
        \end{tcolorbox}
     \end{minipage}%
     \hspace{0.2cm}%
     \begin{minipage}[t]{1.2cm} % 头像宽度
        \begin{tikzpicture}[baseline=(current bounding box.center)]
          \node[circle, draw=gray!50, line width=0.5pt, minimum size=1.2cm, 
                path picture={\node at (path picture bounding box.center) 
                {\includegraphics[width=1.2cm]{#2}};}] {};
        \end{tikzpicture}
     \end{minipage}
    }%
  \par\vspace{0.1cm}% 气泡间距
}

% 添加聊天背景

\pagestyle{fancy}
\fancyhf{} % 清空所有页眉页脚
\fancyhead[LE]{\hspace*{-1.5cm}\includegraphics[width=\paperwidth]{head.pdf}} % 偶数页左侧
\fancyhead[RO]{\hspace*{-1.5cm}\includegraphics[width=\paperwidth]{headr.pdf}} % 奇数页右侧
\renewcommand{\headrulewidth}{0pt}
\setlength{\headsep}{5mm}
\fancyfoot[LE]{\hspace{-1cm}\raisebox{-27pt}{\textcolor{white}{\textbf{\textsf{\thepage}}}}} % 偶数页左侧
\fancyfoot[RO]{\rlap{\hspace{0.8cm}\raisebox{-27pt}{\textcolor{white}{\textbf{\textsf{\thepage}}}}}}
\renewcommand{\footrulewidth}{0pt}
\AddToShipoutPictureBG{%
  \ifodd\value{page}
    \AtPageLowerLeft{%
      \raisebox{15pt}[0pt][0pt]{\includegraphics[width=\paperwidth]{footr.pdf}}%
    }
  \else
    \AtPageLowerLeft{%
      \raisebox{15pt}[0pt][0pt]{\includegraphics[width=\paperwidth]{footl.pdf}}%
    }
  \fi
}
\definecolor{thuorange}{RGB}{247, 148, 29}

\begin{document}
\vspace*{0.7cm}
\begin{center}
    \fontsize{30pt}{32pt}\selectfont
    \textbf{\textcolor{truepurple}{目录}}
    \\[0ex]
    \fontsize{18pt}{20pt}\selectfont
    \textcolor{thuorange}{Contents}
\end{center}
\begin{Large}
\doublespacing
社团介绍\\ 
主要活动介绍\\
社团Q\&A\\
分部介绍
\begin{large}
\begin{itemize}
  \item 组织部门
  \item 创作类
  \item 歌舞艺术类
  \item 综合类
  \item 作品类
  \item 游戏类
  \item 娱乐影视类
  \item 科技生活类
\end{itemize}
\end{large}
\vspace*{0.3cm}
社员寄语
\end{Large}

\newpage
\input{chapters/1_introduction.tex}
\end{document}